<html>
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <!-- The page that will show up after the system identifies that the account login was a technician-->
        <title>Lab Technician Reserve Page</title>
        <link rel="stylesheet" href="labTech_currReservations_design.css"/>

        <!-- Import Bootstrap-->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    </head>

    <body>
        <div class="container-fluid p-0">
            <div class="row g-0">

                <!--Side Panel Content containing navigation links and user account buttons-->
                <div class="col-lg-3 col-md-4">

                    <div class="side-panel">
                        <h1 class="side-panel-title">ReserveALab</h1>

                        <div class="user-account-buttons">
                            <a href="" >
                                <button type="button" class="btn btn-custom"> Logout </button>
                            </a>

                            <a href="" >
                                <button type="button" class="btn btn-custom"> View Availabile Slots </button>
                            </a>
                        </div>

                        <nav>
                            <!-- Will update links later -->
                            <ul class="nav-links">
                                <li><a href="lab_technician_page.html">Technician Homepage </a></li>
                            </ul>
                        </nav>

                    </div>
                </div>

                <!-- Main Content -->

                <div class="col-lg-9 col-md-8">

                    <div class="hero-container">

                        <div class="card">

                            <h2 class="container-title">Current Reservations</h2>

                            <form id="remove-reservation-form">

                                <!-- Reservations Display Containers-->

                                <div id="reservationsContainer" class="reservations-container">
                                    <h4>Existing Reservations</h4>
                                    <div id="reservations-list"></div>

                                    <div id="selectedReservationInfo" class="selected-reservations-info">
                                        <h5>Selected Reservation Details:</h5>
                                        <div id="selectedDetails"></div>
                                        <button type="button" class="btn btn-custom1" id="btn-remove"> Edit Reservation</button>
                                    </div>
                                </div>
                            

                            </form>

                        </div>

                    </div>
                </div>
            </div>
        </div>


        <script>

            const reservationsData = {
                'andre_chu@dlsu.edu.ph':[
                    {
                        id: 1,
                        lab: 'G301', 
                        seat: 20,
                        date: '06-26-2025',
                        time: '7:30 AM - 9:00 AM',
                        status:'upcoming'
                    }, 
                    {
                        id: 2,
                        lab: 'G302', 
                        seat: 5,
                        date: '06-23-2025',
                        time: '9:15 AM - 10:45 AM',
                        status:'upcoming'
                    }
                ], 

                'joaquin_tin@dlsu.edu.ph':[
                    {
                        id: 3,
                        lab: 'G302', 
                        seat: 7,
                        date: '06-27-2025',
                        time: '9:15 AM - 10:45 AM',
                        status:'upcoming'
                    }, 
                    {
                        id: 4,
                        lab: 'G303', 
                        seat: 2,
                        date: '06-13-2025',
                        time: '9:15 AM - 10:45 AM',
                        status:'late'
                    }
                ], 

            
            
            
            }

            let selectedReservation = null;

            function displayAllReservations() {
                const container = document.getElementById('reservationsContainer');
                const list = document.getElementById('reservations-list');

                list.innerHTML = '';
                selectedReservation = null;
                document.getElementById('selectedReservationInfo').style.display = 'none';

                const reservations_made = [];

                for (const email in reservationsData){
                    reservationsData[email].forEach(reservation => {
                        reservations_made.push({
                            ...reservation, 
                            email : email
                        });
                    });
                }
            


                // Check if the email currently exists in the current data
                if(reservations_made.length > 0){


                    // Create a div element for each reservation done by the student
                    reservations_made.forEach(reservation => {
                        const div_reservation = document.createElement('div');
                        div_reservation.className = 'reservation-item';
                        div_reservation.dataset.reservationId = reservation.id;

                        div_reservation.innerHTML = 
                        `
                        <div class="student-reservation-details">
                            <div class="reservation-info">
                                <h4> ${reservation.lab} - Seat ${reservation.seat}</h4>
                                <p> Date - ${reservation.date} </p>
                                <p> Time - ${reservation.time} </p>
                            </div>

                            <div class="reservation-status status-${reservation.status}">
                                ${reservation.status.toUpperCase()}
                            </div>

                        </div>
                        `;

                        div_reservation.addEventListener('click', function(){
                            selectReservation(reservation, div_reservation);
                        });

                        list.appendChild(div_reservation);

                    });

                    container.style.display = 'block';

                } else {
                    //No reservations were made by the student 
                    list.innerHTML = '<div class="no-reservations">No reservations for this account</div>';
                    container.style.display = 'block';
                }     
            }   

            document.addEventListener('DOMContentLoaded', function() {
                displayAllReservations();
            });


        </script>
        
    </body>


</html> 