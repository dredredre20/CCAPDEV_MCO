<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Edit Reservation</title>
  <link rel="stylesheet" href="/css/new-edit_reserve.css" />

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
</head>

<body>
  <div class="container-fluid p-0">
    <div class="row g-0">

      <!-- Side Panel -->
      <div class="col-lg-3 col-md-4">
        <div class="side-panel">
          <h1 class="side-panel-title">ReserveALab</h1>

          <div class="user-account-buttons">
            <a href="/user-login">
              <button type="button" class="btn btn-custom">Logout</button>
            </a>

            <a href="/view-slots">
              <button type="button" class="btn btn-custom">View Available Slots</button>
            </a>
          </div>

          <nav>
            <ul class="nav-links">
              <li><a href="/student?userId={{userId}}">Student Homepage</a></li>
            </ul>
          </nav>
        </div>
      </div>

      <!-- Main Content -->
      <div class="col-lg-9 col-md-8">
        <div class="hero-container">
          <h2 class="hero-title">Edit Your Reservation</h2>

          <form method="POST" action="/student/edit-reservation">
            <input type="hidden" name="userId" value="{{userId}}">
            <input type="hidden" name="reservationId" value="{{reservation._id}}">

            <div class="form-group">
              <label for="laboratory">Laboratory:</label>
              <select id="laboratory" name="laboratory" required>
                <option value="G301" {{#ifEquals reservation.laboratory "G301"}}selected{{/ifEquals}}>G301</option>
                <option value="G302" {{#ifEquals reservation.laboratory "G302"}}selected{{/ifEquals}}>G302</option>
                <option value="G303" {{#ifEquals reservation.laboratory "G303"}}selected{{/ifEquals}}>G303</option>
                <option value="G304" {{#ifEquals reservation.laboratory "G304"}}selected{{/ifEquals}}>G304</option>
                <option value="G305" {{#ifEquals reservation.laboratory "G305"}}selected{{/ifEquals}}>G305</option>
              </select>
            </div>

            <div class="form-group">
              <label for="reservation_date">Date:</label>
              <input type="date" id="reservation_date" name="reservation_date" value="{{reservation.reservation_date}}" required>
            </div>

            <div class="form-group">
              <label for="time">Time Slot:</label>
              <select id="time" name="time" required>
                <option value="08:00" {{#ifEquals reservation.time "08:00"}}selected{{/ifEquals}}>08:00 - 08:30</option>
                <option value="08:30" {{#ifEquals reservation.time "08:30"}}selected{{/ifEquals}}>08:30 - 09:00</option>
                <option value="09:00" {{#ifEquals reservation.time "09:00"}}selected{{/ifEquals}}>09:00 - 09:30</option>
                <option value="09:30" {{#ifEquals reservation.time "09:30"}}selected{{/ifEquals}}>09:30 - 10:00</option>
                <option value="10:00" {{#ifEquals reservation.time "10:00"}}selected{{/ifEquals}}>10:00 - 10:30</option>
                <option value="10:30" {{#ifEquals reservation.time "10:30"}}selected{{/ifEquals}}>10:30 - 11:00</option>
                <option value="11:00" {{#ifEquals reservation.time "11:00"}}selected{{/ifEquals}}>11:00 - 11:30</option>
                <option value="11:30" {{#ifEquals reservation.time "11:30"}}selected{{/ifEquals}}>11:30 - 12:00</option>
                <option value="12:00" {{#ifEquals reservation.time "12:00"}}selected{{/ifEquals}}>12:00 - 12:30</option>
                <option value="12:30" {{#ifEquals reservation.time "12:30"}}selected{{/ifEquals}}>12:30 - 01:00</option>
                <option value="01:00" {{#ifEquals reservation.time "01:00"}}selected{{/ifEquals}}>01:00 - 01:30</option>
              </select>
            </div>

            <div class="form-group">
              <label for="seat_number">Seat Number (1-35):</label>
              <input type="number" id="seat_number" name="seat_number" min="1" max="35" value="{{reservation.seat_number}}" required>
            </div>

            <button type="submit" class="btn btn-primary">Update Reservation</button>
          </form>

          {{#if error}}
            <div class="alert alert-danger mt-3">{{error}}</div>
          {{/if}}

          {{#if success}}
            <div class="alert alert-success mt-3">{{success}}</div>
          {{/if}}

          <div>
            <h3>Your Reservations</h3>
            <ul>
              {{#each reservations}}
                <li>
                  {{laboratory}} - {{reservation_date}} - {{time_slot}} - Seat {{seat_number}}
                  <a href="/student/edit-reservation/{{_id}}?userId={{../userId}}">Edit</a>
                </li>
              {{/each}}
            </ul>
          </div>
        </div>
      </div>

    </div>
  </div>
</body>
</html>
